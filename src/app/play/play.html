@if (gameState.state === 'disconnected') {
  <div class="login-container">
    <form class="login-form" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <input
          type="text"
          [(ngModel)]="name"
          name="name"
          placeholder="Your Name"
          required
          [disabled]="isConnecting">
      </div>

      @if (showLobbyInput) {
        <div class="form-group">
          <input
            type="text"
            [(ngModel)]="lobbyCode"
            name="lobbyCode"
            placeholder="Lobby Code"
            required
            [disabled]="isConnecting">
        </div>
      }

      @if (error) {
        <div class="error-message">
          {{ error }}
        </div>
      }

      <button type="submit" [disabled]="!name || !lobbyCode || isConnecting">
        @if (isConnecting) {
          Connecting...
        } @else {
          Join
        }
      </button>
    </form>
  </div>
} @else if (gameState.state === 'question' && currentQuestion) {
  <div class="question-container">
    <div class="question-text">
      {{ currentQuestion.data.question }}
    </div>

    @if (isMultipleChoice(currentQuestion.data)) {
      <div class="options-container">
        @for (option of currentQuestion.data.options; track option; let i = $index) {
          <button
            class="option-button"
            [class.selected]="selectedOption === i.toString()"
            [disabled]="answerSubmitted"
            (click)="selectOption(i.toString())">
            {{ option }}
          </button>
        }
      </div>
    } @else if (isNumerical(currentQuestion.data)) {
      <div class="numerical-input">
        @for (answer of currentQuestion.data.answers; track answer; let idx = $index) {
          <input
            type="number"
            [step]="isNumerical(currentQuestion.data) && currentQuestion.data.type === 'float' ? 'any' : '1'"
            [(ngModel)]="numericalAnswers[idx]"
            [name]="'numericalAnswer' + idx"
            [placeholder]="'Enter answer ' + (idx + 1)"
            [disabled]="answerSubmitted"
            class="answer-input">
        }
      </div>
    }

    @if (!answerSubmitted) {
      <button
        class="submit-answer"
        [disabled]="!hasValidAnswer()"
        (click)="submitAnswer()">
        Submit Answer
      </button>
    } @else {
      <div class="answer-submitted">
        Answer Submitted
      </div>
    }
  </div>
} @else if (gameState.state === 'question_review' && currentQuestion) {
  <div class="question-container">
    <div class="question-text">
      {{ currentQuestion.data.question }}
    </div>

    @if (questionGrade !== null) {
      <div class="grade-result" [class.correct]="questionGrade" [class.incorrect]="!questionGrade">
        {{ questionGrade ? 'Correct!' : 'Incorrect' }}
      </div>
    }

    <div class="answer-display">
      Your answer:
      @if (isMultipleChoice(currentQuestion.data)) {
        {{ currentQuestion.data.options[parseOptionIndex(selectedOption)] }}
      } @else if (isNumerical(currentQuestion.data)) {
        @for (answer of numericalAnswers; track answer; let i = $index) {
          <div>Answer {{i + 1}}: {{ answer }}</div>
        }
      }
    </div>
  </div>
} @else if (gameState.state === 'waiting') {
  <div class="waiting-container">
    <h2>Waiting for activity to start...</h2>
  </div>
} @else if (gameState.state === 'finished') {
  <div class="finished-container">
    <h2>Activity Over!</h2>
  </div>
}